/* Go.js SDK by Luis Carlos Hurtado - MIT Licence - luiscarloshurtado@live.com */
Go.namespace("nav").start=async function(){document.body.onclick=function(t){Go.do("nav/event",t)},window.addEventListener("popstate",function(){Go.dispatch("nav.fetch",window.location.pathname)}),Go.config("routerPreventAutoStart")||Go.dispatch("nav.fetch",window.location.pathname)},Go.namespace("nav").event=function(t){var[e,o]=[t.target.href,"_blank"===t.target.target];return o||e&&(Go.prevent(t),Go.dispatch("nav.push",e)),this},Go.namespace("nav").getRouteFullHash=(t=null)=>{if(window.location.hash)return t=views[window.location.hash]||views[window.location.hash+"/"],(t||=views[window.location.pathname+window.location.hash])||views[Go.removeLastStringIf(window.location.hash,"/")]},Go.namespace("nav").getRoute=function(t=window.location.pathname,e=window.views){let o=Go.do("nav/getRouteFullHash");var a=Go.url(Go.base()).removeHost(),a=location.href.split(a)[1];return o=(o=(o||=e[t]||e[window.location.pathname]||e["/"+window.location.pathname])||(e[window.location.pathname+"/"]||e["/"+window.location.pathname+"/"]))||e[Go.removeLastStringIf(window.location.pathname,"/")],o=a?(o=(o=(o=(o||=e[a])||e["/"+a])||e[a+"/"])||e["/"+a+"/"])||e[Go.removeLastStringIf(a,"/")]:o},Go.namespace("nav").getRouteByName=function(e){let[o,a]=[!1,Object.keys(views)];if(e)for(let t=0;t<a.length;t++){var[,i]=[a[t],views[a[t]]];if(i.name===e){o=i;break}}return o},Go.namespace("nav").getView=function(t=window.location.pathname){let e=Go.do("nav/getRoute",t);return e=(e=(e||=Go.do("nav/getRouteGlobal",t))||Go.do("nav/getRouteByName",t))||views[404],e=Go.is(e,"function")?e():e},Go.namespace("nav").getRouteGlobal=function(t=window.location.pathname){let[e,o,a]=[!1,0,Object.keys(views)];for(o=0;o<a.length;o++){var i=a[o];if(Go.includes(i,"*")){var n=Go.removeLastStringIf(i.split("*")[0],"/");if(Go.includes(t,n)){e=views[i];break}}}return e},Go.namespace("nav").if=async function(route={}){let[si,can,_route]=[!1,!0,{...route,if:!1}];return route.if&&Go.is(route.if,"function")?(si=!0,can=await route.if()):Go.is(route.if,"set")&&(si=!0,can=await eval(route.if)),si&&!can&&Go.is(route.else,"function")?_route=await route.else():si&&!can&&Go.is(route.else,"string")?_route=eval(route.else):si&&!can&&(_route=route.else),_route&&_route.if?Go.do("nav/if",_route):_route},Go.namespace("nav").fetch=async function(t=window.location.pathname){let[e,o]=[t,null];if(e&&(e.isChild||(e=await Go.dispatch("nav/getView",t)),!(e=(e=Go.is(e,"function")?await e():e).if?await Go.do("nav/if",e):e).break)&&(e||=Go.do("nav/getRouteByName","404"))){if(e.uuid=Go.uuid(),o=Go.config("currentRoute")||{},this.alreadyOnRoute=!e.isChild&&e.key&&o.key===e.key,!this.alreadyOnRoute){e.isChild||Go.config("currentRoute",e),e.loader=await Go.loader(Go.config("loaderSelector")),e.loaderId=e.loader.id,Go.emit("beforeRoute",e),Go.is(e.beforeRoute,"function")&&await e.beforeRoute(),e.components||=[];let a=e.headers||{};Go.is(a,"function")&&(a=await a()),await Go.for(e.styles,t=>{Go.load(Go.eval(t))}),await Go.for(e.components,async t=>{var o=document.querySelector(Go.eval(t.target));if(o){Go.attrs(o,{state:"leaving"});let e="";try{e=await Go.xhr(Go.eval(t.src),{responseType:"text",headers:a})}catch(t){e=Go.getErrorMessage(t)}Go.attrs(o,{state:"rendering"}),Go.html(o,Go.eval(e)),await Go.sleep(100),Go.attrs(o,{state:"rendered"}),await Go.sleep(100),Go.attrs(o,{state:"loaded"}),o.scrollIntoView()}});if(e.html&&e.target){let t=document.querySelector(Go.eval(e.target));(t=t||await Go.awaitElement(Go.eval(e.target),{timeout:1e4}))&&await(async t=>{if(Go.attrs(t,{state:"leaving"}),Go.is(e.html,"function"))e.html=await e.html();else if(Go.is(e.html,"path"))try{e.html=await Go.xhr(Go.eval(e.html),{responseType:"text",headers:a})}catch(t){e.html=Go.getErrorMessage(t)}return Go.attrs(t,{state:"rendering"}),Go.is(e.html,"HTMLElement")?(t.innerHTML="",t.append(e.html)):Go.html(t,Go.eval(e.html)),await Go.sleep(100),Go.attrs(t,{state:"rendered"}),await Go.sleep(100),Go.attrs(t,{state:"loaded"}),t.scrollIntoView(),Promise.resolve()})(t)}e.scripts||=[],e.script&&Go.is(e.script,"string")?e.scripts.push({src:e.script}):e.script&&Go.is(e.script,"object")&&e.scripts.push(e.script),await Go.for(e.scripts,t=>{Go.load(Go.eval(t.src),{...t})}),e.module&&await Go.do("nav/module",e),e.title&&Go.docTitle(Go.eval(e.title));var t=e.onRoute||e.onroute||e.fn||e.function||e.do,i={route:e,path:location.pathname};Go.is(t,"function")?t(i):t&&Go.eval(t),Go.emit("route",i),await Go.sleep(100),document.body.scrollTop=0;try{await Go.do("nav/children",e)}catch(t){}return e.loader&&Go.is(e.loader.close,"function")&&e.loader.close(),Go.is(e.afterRoute,"function")&&await e.afterRoute(),Go.emit("afterRoute",e)}Go.do("nav/children",e)}},Go.set("nav").children=async function(e={}){if(Go.do("nav/markLinks"),e.routes||=e.views,e.routes){Go.is(e.routes,"function")&&(e.routes=await e.routes());var o=location.pathname.split(e.parent)[1]||"/";let t=e.routes[o]||e.routes[o+"/"];if(t=(t=(t=(t||=e.routes[Go.removeLastStringIf(o,"/")])||(e.routes["/"+o]||e.routes["/"+o+"/"]))||await Go.do("nav/getChildrenRouteGlobal",o,e.routes))||(e.routes["*"]||e.routes["/*"]))return Go.is(t,"function")&&(t=await t()),Go.config("current/"+e.parent,t),t.isChild=!0,Go.do("nav/fetch",t)}},Go.set("nav").getChildrenRouteGlobal=function(t,e){let[o,a,i]=[!1,0,Object.keys(e)];for(a=0;a<i.length;a++){var n=i[a];if(Go.includes(n,"*")){var r=Go.removeLastStringIf(n.split("*")[0],"/");if(Go.includes(t,r)){o=e[n];break}}}return o},Go.set("nav").module=async function(t){return this.module=await Go.module({src:t.module,props:t.props}),this.template=this.module.template,this.render=this.module.render,this.target=this.module.target,Go.is(this.template,"function")&&(this.template=await this.template()),this.target&&this.template&&Go.html(this.target,this.template),this.module},Go.namespace("nav").push=function(t){t=Go.fix(t).url(),window.history.pushState({},"",t),window.dispatchEvent(new Event("popstate"))},Go.namespace("nav").refresh=function(){Go.config("currentRoute",{}),window.dispatchEvent(new Event("popstate"))},Go.namespace("nav").query=function(t={}){var e=window.location.href,o=window.location.hash,a=window.location.search;let i=e.replace(a,"");i=i.replace(o,"");e=Go.removeFirstIf(a,"?")+"&"+Go.serializeObject(t),e=Go.quitDuplicateQuery(e),a=i+"?"+e+o;Go.dispatch("nav/push",a),Go.dispatch("nav/refresh")},Go.set("nav").isHome=()=>{return"home"===(Go.config("currentRoute")||{}).name||Go.base()===location.href},Go.set("nav").markLinks=function(){this.links=document.querySelectorAll("a"),this.style="",Go.for(this.links,t=>{location.href===t.href?t.classList.add("active"):t.classList.remove("active")});var t=Go.url(location.href).removeBase();this.style+=`[href="${t}"],`,this.style+=`[href="${location.pathname}"],`,this.style+=`[href="${Go.host("",location.pathname)}"] {`,this.style+="color: var(--link-active-color);",this.style+="background-color: var(--link-active-background);",this.style+="border-radius: var(--link-active-border-radius, inherit);",this.style+="}",this.style+=`[parent*="${t}"],`,this.style+=`[parent*="${location.pathname}"],`,this.style+=`[parent*="${Go.host("",location.pathname)}"] {`,this.style+="color: var(--link-active-color-parent);",this.style+="background-color: var(--link-active-background-parent);",this.style+="border-radius: var(--link-active-border-radius, inherit-parent);",this.style+="}",Go.cssTag("go-router",this.style)};